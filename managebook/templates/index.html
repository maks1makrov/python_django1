{% extends 'main_template.html' %}
{% block index %}
<a href="{% url 'add_book' %}">Add new book</a>
{% for book in content %}
    <h1>{{ book.title }}</h1>
    {% if book.is_owner %}
        <p><a href="{% url 'delete_book' book_id=book.id %}">Delete book</a></p>
        <p><a href="{% url 'update_book' book_slug=book.slug %}">Update book</a></p>
    {% endif  %}
    <h5>{{ book.text}}</h5>
    <h5>Rate: {{ book.cached_rate}}</h5>
    {% for i in '0123456789'%}
        <a href="{% url 'add_rate' rate=i book_id=book.id %}">
            {% if i <= book.user_rate%}
                <span class="fa fa-star checked"></span>
            {% else %}
                <span class="fa fa-star"></span>
            {% endif %}
        </a>
    {% endfor %}
<p>Date: {{book.publish_date}}</p>

    <p>Authors: {% for author in book.author.all%}
        {{ author.username}}
        {%endfor%}</p>
    <p>Genre: {% for genre in book.genre.all%}
        {{ genre.title}},
        {%endfor%}</p>
    {% for c in book.comment.all%}
        {{ c.is_owner}}
        <h5>comment: {{c.text}}</h5>
        <p>{{c.date}}</p>
        <p>{{c.user}}</p>
        <i>likes: {{c.cached_like}}</i>
        <i>
            {% for u in c.like.all %}
            <span>{{ u }}</span>
            {% endfor %}
        </i>

        <a href="{% url 'add_like' comment_id=c.id %}"><i>add like for this comment</i></a>
        <br>
        {% if c.is_owner %}
        <a href="{% url 'delete_comment' comment_id=c.id %}">Delete this comment</a>
        <a href="{% url 'update_comment' comment_id=c.id %}">Update this comment</a>
        <br><br>
        {%  endif %}


    {% endfor %}
        <form action="{% url 'add_comment' book_id=book.id %}" method="post">
            {% csrf_token %}
            {{ form }}
        <button type="submit">OK</button>
        </form>

<hr>
            {%endfor%}

{% endblock %}